<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CivicLabs - Community Engagement Platform</title>
    <meta name="description" content="CivicLabs - Comprehensive community engagement platform for local governments and civic organizations. Connect with residents on public issues, gather feedback, and foster transparent collaboration.">
    <meta name="keywords" content="civic engagement, community participation, public consultation, local government, citizen feedback, community challenges, civic technology">
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
            line-height: 1.6;
            color: #1f2937;
            background: #f8fafc;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 1rem;
        }

        .header {
            background: var(--primary-color, #2563eb);
            color: white;
            padding: 1rem 0;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 1rem;
        }

        .logo {
            font-size: 1.5rem;
            font-weight: bold;
        }

        .nav-links {
            display: flex;
            gap: 2rem;
        }

        .nav-links a {
            color: white;
            text-decoration: none;
            padding: 0.5rem 1rem;
            border-radius: 0.5rem;
            transition: background 0.2s;
        }

        .nav-links a:hover {
            background: rgba(255,255,255,0.1);
        }

        .hero {
            text-align: center;
            padding: 4rem 0;
            background: linear-gradient(135deg, var(--primary-color, #2563eb), #1e40af);
            color: white;
        }

        .hero h1 {
            font-size: 3rem;
            margin-bottom: 1rem;
        }

        .hero p {
            font-size: 1.2rem;
            max-width: 600px;
            margin: 0 auto 2rem;
            opacity: 0.9;
        }

        .btn {
            background: white;
            color: var(--primary-color, #2563eb);
            padding: 0.75rem 2rem;
            border: none;
            border-radius: 0.5rem;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
        }

        .section {
            padding: 4rem 0;
        }

        .section h2 {
            text-align: center;
            font-size: 2rem;
            margin-bottom: 3rem;
            color: #1f2937;
        }

        .challenges-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
            margin-bottom: 3rem;
        }

        .challenge-card {
            background: white;
            border-radius: 1rem;
            padding: 2rem;
            box-shadow: 0 4px 20px rgba(0,0,0,0.05);
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .challenge-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 30px rgba(0,0,0,0.1);
        }

        .challenge-title {
            font-size: 1.25rem;
            font-weight: 600;
            margin-bottom: 1rem;
            color: var(--primary-color, #2563eb);
        }

        .challenge-description {
            color: #6b7280;
            margin-bottom: 1.5rem;
        }

        .challenge-meta {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 0.875rem;
            color: #9ca3af;
        }

        .contribute-form {
            background: white;
            border-radius: 1rem;
            padding: 2rem;
            box-shadow: 0 4px 20px rgba(0,0,0,0.05);
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 500;
        }

        .form-group input,
        .form-group textarea,
        .form-group select {
            width: 100%;
            padding: 0.75rem;
            border: 2px solid #e5e7eb;
            border-radius: 0.5rem;
            font-size: 1rem;
        }

        .form-group textarea {
            min-height: 120px;
            resize: vertical;
        }

        .contributions {
            display: grid;
            gap: 1rem;
        }

        .contribution {
            background: white;
            border-radius: 0.75rem;
            padding: 1.5rem;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            border-left: 4px solid var(--primary-color, #2563eb);
        }

        .contribution-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .contribution-title {
            font-weight: 600;
            color: #1f2937;
        }

        .contribution-type {
            background: var(--primary-color, #2563eb);
            color: white;
            padding: 0.25rem 0.75rem;
            border-radius: 1rem;
            font-size: 0.75rem;
            font-weight: 500;
        }

        .contribution-content {
            color: #6b7280;
            line-height: 1.6;
        }

        .admin-panel {
            position: fixed;
            top: 1rem;
            right: 1rem;
            background: white;
            border-radius: 0.5rem;
            padding: 1rem;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            border: 2px solid #e5e7eb;
        }

        .admin-btn {
            background: #f59e0b;
            color: white;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 0.25rem;
            font-size: 0.875rem;
            cursor: pointer;
        }

        .admin-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }

        .admin-modal {
            background: white;
            border-radius: 1rem;
            padding: 2rem;
            width: 90%;
            max-width: 600px;
            max-height: 90vh;
            overflow-y: auto;
        }

        .admin-form {
            display: grid;
            gap: 1.5rem;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
        }

        .form-actions {
            display: flex;
            gap: 1rem;
            justify-content: flex-end;
            margin-top: 2rem;
        }

        .btn-secondary {
            background: #6b7280;
            color: white;
        }

        .hidden {
            display: none !important;
        }

        .loading {
            text-align: center;
            padding: 2rem;
            color: #6b7280;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .error {
            background: #fee2e2;
            color: #dc2626;
            padding: 1rem;
            border-radius: 0.5rem;
            margin: 1rem 0;
        }

        @media (max-width: 768px) {
            .nav {
                flex-direction: column;
                gap: 1rem;
            }

            .nav-links {
                gap: 1rem;
            }

            .hero h1 {
                font-size: 2rem;
            }

            .challenges-grid {
                grid-template-columns: 1fr;
            }

            .form-row {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div id="root">
        <div style="text-align: center; padding: 50px; font-family: Arial, sans-serif;">
            <h2>Loading CivicLabs...</h2>
            <p>Please wait while the application loads.</p>
            <div style="margin: 20px 0;">
                <div style="width: 40px; height: 40px; border: 4px solid #f3f3f3; border-top: 4px solid #2563eb; border-radius: 50%; animation: spin 1s linear infinite; margin: 0 auto;"></div>
            </div>
            <p style="color: #666; font-size: 14px;">If this takes more than 30 seconds, please refresh the page.</p>
        </div>
    </div>

    <script type="text/babel">
        // Load Fireproof from ESM.sh
        const script = document.createElement('script');
        script.type = 'module';
        script.textContent = `
            import { useFireproof } from "https://esm.sh/use-fireproof";

            // Initialize Fireproof database
            const { database, useDocument, useLiveQuery } = useFireproof('civiclabs');

            // Configuration
            let config = {
                orgName: "My Civic Organization",
                primaryColor: "#2563eb",
                contactEmail: "contact@example.com",
                logoUrl: "",
                welcomeMessage: "Welcome to our community engagement platform. Help us shape the future of our community by sharing your ideas and participating in local initiatives.",
                tagline: "Your voice matters in building a stronger community",
                organizationType: "Local Government",
                currentCampaigns: [
                    "Community Garden Initiative",
                    "Public Transit Survey",
                    "Youth Mentorship Program"
                ],
                enableSurveys: true,
                enableVolunteering: true,
                enablePublicConsultations: true,
                moderationSettings: {
                    requireApproval: false,
                    enableModeration: true,
                    allowAnonymous: true
                }
            };

            // Load config from localStorage or use defaults
            const savedConfig = localStorage.getItem('civiclabs-config');
            if (savedConfig) {
                config = { ...config, ...JSON.parse(savedConfig) };
            }

            // Update CSS custom properties
            function updateTheme() {
                document.documentElement.style.setProperty('--primary-color', config.primaryColor);
            }

            updateTheme();

            function CivicLabsApp() {
                const [activeTab, setActiveTab] = React.useState('home');
                const [showAdmin, setShowAdmin] = React.useState(false);
                const [contributions, setContributions] = React.useState([]);
                const [challenges, setChallenges] = React.useState([
                    {
                        id: 1,
                        title: "Community Garden Initiative",
                        description: "Help us plan and implement community gardens across the city to improve food security and green spaces. We're looking for volunteers to help design, build, and maintain these vital community resources.",
                        status: "active",
                        participants: 24,
                        type: "Community Initiative",
                        category: "Environment & Sustainability",
                        deadline: "2024-12-31",
                        joinUrl: "#join-garden",
                        surveyUrl: "#garden-survey",
                        volunteerSlots: 15,
                        currentVolunteers: 8,
                        impact: "Improve food access for 500+ families and create 3 new green spaces"
                    },
                    {
                        id: 2,
                        title: "Public Transit Survey",
                        description: "Share your experiences with public transportation to help improve routes and schedules. Your feedback will directly influence the next 5-year transit plan.",
                        status: "active",
                        participants: 156,
                        type: "Public Consultation",
                        category: "Transportation & Infrastructure",
                        deadline: "2024-11-15",
                        joinUrl: "#transit-survey",
                        surveyUrl: "#transit-feedback",
                        responses: 156,
                        targetResponses: 200,
                        impact: "Shape the future of public transportation for 50,000+ daily riders"
                    },
                    {
                        id: 3,
                        title: "Youth Mentorship Program",
                        description: "Connect experienced professionals with young people seeking career guidance and opportunities. Help build the next generation of community leaders.",
                        status: "planning",
                        participants: 8,
                        type: "Mentorship Program",
                        category: "Education & Youth Development",
                        deadline: "2024-10-30",
                        joinUrl: "#youth-mentorship",
                        volunteerSlots: 20,
                        currentVolunteers: 3,
                        impact: "Provide career guidance to 100+ young people and build community capacity"
                    }
                ]);

                // Load contributions from Fireproof
                React.useEffect(() => {
                    const loadContributions = async () => {
                        try {
                            const { docs } = database.useLiveQuery("_id", { descending: true });
                            setContributions(docs || []);
                        } catch (error) {
                            console.error('Error loading contributions:', error);
                        }
                    };
                    loadContributions();
                }, []);

                const handleSubmitContribution = async (formData) => {
                    try {
                        const { submit } = database.useDocument({
                            title: formData.title,
                            content: formData.content,
                            type: formData.type,
                            author: formData.author,
                            createdAt: new Date().toISOString()
                        });

                        await submit();

                        // Refresh contributions
                        const { docs } = database.useLiveQuery("_id", { descending: true });
                        setContributions(docs || []);

                        setActiveTab('contributions');
                    } catch (error) {
                        console.error('Error submitting contribution:', error);
                        alert('Error submitting contribution. Please try again.');
                    }
                };

                const handleSaveConfig = (newConfig) => {
                    config = { ...config, ...newConfig };
                    localStorage.setItem('civiclabs-config', JSON.stringify(config));
                    updateTheme();
                    setShowAdmin(false);
                };

                return (
                    <div>
                        {/* Header */}
                        <header className="header">
                            <div className="nav">
                                <div className="logo">{config.orgName}</div>
                                <nav className="nav-links">
                                    <a href="#" onClick={() => setActiveTab('home')}>Home</a>
                                    <a href="#" onClick={() => setActiveTab('challenges')}>Challenges</a>
                                    <a href="#" onClick={() => setActiveTab('contribute')}>Contribute</a>
                                    <a href="#" onClick={() => setActiveTab('contributions')}>Community</a>
                                </nav>
                            </div>
                        </header>

                        {/* Admin Panel Button */}
                        <div className="admin-panel">
                            <button className="admin-btn" onClick={() => setShowAdmin(true)}>
                                ‚öôÔ∏è Admin
                            </button>
                        </div>

                        {/* Main Content */}
                        <main>
                            {/* Home Tab */}
                            {activeTab === 'home' && (
                                <div className="hero">
                                    <div className="container">
                                        <div className="hero-content">
                                            <h1>Welcome to {config.orgName}</h1>
                                            <p>{config.welcomeMessage}</p>
                                            <p style={{fontSize: '1.1rem', marginBottom: '2rem', opacity: 0.9}}>
                                                {config.tagline}
                                            </p>
                                            <div style={{display: 'flex', gap: '1rem', justifyContent: 'center', flexWrap: 'wrap'}}>
                                                <button className="btn btn-primary" onClick={() => setActiveTab('challenges')}>
                                                    Explore Active Challenges
                                                </button>
                                                <button className="btn btn-outline" onClick={() => setActiveTab('contribute')}>
                                                    Share Your Ideas
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            )}

                            {/* Challenges Tab */}
                            {activeTab === 'challenges' && (
                                <section className="section">
                                    <div className="container">
                                        <div className="section-header">
                                            <h2 className="section-title">Active Community Challenges</h2>
                                            <p className="section-subtitle">Join these initiatives to help shape our community's future</p>
                                        </div>

                                        <div className="challenges-grid">
                                            {challenges.map(challenge => (
                                                <div key={challenge.id} className="challenge-card">
                                                    <div className="challenge-header">
                                                        <div>
                                                            <div className="challenge-title">{challenge.title}</div>
                                                            <div className="challenge-category">{challenge.category}</div>
                                                        </div>
                                                        <div className={"challenge-status " + challenge.status}>
                                                            {challenge.status}
                                                        </div>
                                                    </div>

                                                    <div className="challenge-description">{challenge.description}</div>

                                                    <div className="challenge-meta">
                                                        <div style={{display: 'flex', alignItems: 'center', gap: '1rem'}}>
                                                            <span>üë• {challenge.participants} participants</span>
                                                            <span>üìÖ Due: {new Date(challenge.deadline).toLocaleDateString()}</span>
                                                        </div>
                                                    </div>

                                                    {/* Progress indicators for different challenge types */}
                                                    {challenge.type === "Public Consultation" && (
                                                        <div style={{marginBottom: '1rem'}}>
                                                            <div style={{display: 'flex', justifyContent: 'space-between', marginBottom: '0.5rem'}}>
                                                                <span style={{fontSize: '0.9rem'}}>Survey Responses</span>
                                                                <span style={{fontSize: '0.9rem'}}>{challenge.responses}/{challenge.targetResponses}</span>
                                                            </div>
                                                            <div style={{
                                                                width: '100%',
                                                                height: '8px',
                                                                background: 'var(--gray-200)',
                                                                borderRadius: '4px',
                                                                overflow: 'hidden'
                                                            }}>
                                                                <div style={{
                                                                    width: `${Math.min((challenge.responses / challenge.targetResponses) * 100, 100)}%`,
                                                                    height: '100%',
                                                                    background: 'var(--primary-color)',
                                                                    transition: 'width 0.3s'
                                                                }}></div>
                                                            </div>
                                                        </div>
                                                    )}

                                                    {challenge.type === "Community Initiative" && (
                                                        <div style={{marginBottom: '1rem'}}>
                                                            <div style={{display: 'flex', justifyContent: 'space-between', marginBottom: '0.5rem'}}>
                                                                <span style={{fontSize: '0.9rem'}}>Volunteer Spots</span>
                                                                <span style={{fontSize: '0.9rem'}}>{challenge.currentVolunteers}/{challenge.volunteerSlots}</span>
                                                            </div>
                                                            <div style={{
                                                                width: '100%',
                                                                height: '8px',
                                                                background: 'var(--gray-200)',
                                                                borderRadius: '4px',
                                                                overflow: 'hidden'
                                                            }}>
                                                                <div style={{
                                                                    width: `${Math.min((challenge.currentVolunteers / challenge.volunteerSlots) * 100, 100)}%`,
                                                                    height: '100%',
                                                                    background: 'var(--success-color)',
                                                                    transition: 'width 0.3s'
                                                                }}></div>
                                                            </div>
                                                        </div>
                                                    )}

                                                    <div style={{marginTop: '1.5rem'}}>
                                                        <div style={{fontSize: '0.9rem', color: 'var(--gray-600)', marginBottom: '1rem'}}>
                                                            <strong>Expected Impact:</strong> {challenge.impact}
                                                        </div>

                                                        <div style={{display: 'flex', gap: '0.5rem', flexWrap: 'wrap'}}>
                                                            <button className="btn btn-primary" style={{fontSize: '0.9rem', padding: '0.5rem 1rem'}}>
                                                                Join Initiative
                                                            </button>
                                                            {config.enableSurveys && (
                                                                <button className="btn btn-secondary" style={{fontSize: '0.9rem', padding: '0.5rem 1rem'}}>
                                                                    Take Survey
                                                                </button>
                                                            )}
                                                            {config.enableVolunteering && challenge.type === "Community Initiative" && (
                                                                <button className="btn btn-outline" style={{fontSize: '0.9rem', padding: '0.5rem 1rem'}}>
                                                                    Volunteer
                                                                </button>
                                                            )}
                                                        </div>
                                                    </div>
                                                </div>
                                            ))}
                                        </div>
                                    </div>
                                </section>
                            )}

                            {/* Contribute Tab */}
                            {activeTab === 'contribute' && (
                                <section className="section">
                                    <div className="container">
                                        <div className="section-header">
                                            <h2 className="section-title">Share Your Ideas & Feedback</h2>
                                            <p className="section-subtitle">Help us understand what matters most to our community</p>
                                        </div>

                                        <div style={{maxWidth: '800px', margin: '0 auto'}}>
                                            <div style={{
                                                background: 'white',
                                                borderRadius: '1.5rem',
                                                padding: '3rem',
                                                boxShadow: '0 10px 40px rgba(0,0,0,0.05)',
                                                border: '2px solid var(--gray-100)'
                                            }}>
                                                <div style={{textAlign: 'center', marginBottom: '2rem'}}>
                                                    <h3 style={{fontSize: '1.5rem', fontWeight: '600', color: 'var(--gray-900)', marginBottom: '0.5rem'}}>
                                                        üí° Share Your Thoughts
                                                    </h3>
                                                    <p style={{color: 'var(--gray-600)'}}>
                                                        Your ideas help shape our community's future. Whether it's a suggestion, concern, or innovative solution - we want to hear from you.
                                                    </p>
                                                </div>

                                                <ContributionForm onSubmit={handleSubmitContribution} />

                                                {config.moderationSettings.allowAnonymous && (
                                                    <div style={{
                                                        background: 'var(--gray-50)',
                                                        borderRadius: '0.75rem',
                                                        padding: '1rem',
                                                        marginTop: '1.5rem',
                                                        fontSize: '0.9rem',
                                                        color: 'var(--gray-600)',
                                                        textAlign: 'center'
                                                    }}>
                                                        <strong>Privacy Note:</strong> You can choose to submit anonymously. All contributions are reviewed before publication to ensure respectful dialogue.
                                                    </div>
                                                )}
                                            </div>
                                        </div>
                                    </div>
                                </section>
                            )}

                            {/* Community Contributions Tab */}
                            {activeTab === 'contributions' && (
                                <section className="section">
                                    <div className="container">
                                        <div className="section-header">
                                            <h2 className="section-title">Community Dialogue</h2>
                                            <p className="section-subtitle">See what your neighbors are saying and join the conversation</p>
                                        </div>

                                        <div style={{maxWidth: '1000px', margin: '0 auto'}}>
                                            {contributions.length === 0 ? (
                                                <div style={{
                                                    background: 'white',
                                                    borderRadius: '1.5rem',
                                                    padding: '4rem',
                                                    textAlign: 'center',
                                                    boxShadow: '0 10px 40px rgba(0,0,0,0.05)'
                                                }}>
                                                    <div style={{fontSize: '4rem', marginBottom: '1rem'}}>üí¨</div>
                                                    <h3 style={{fontSize: '1.5rem', fontWeight: '600', color: 'var(--gray-900)', marginBottom: '0.5rem'}}>
                                                        Start the Conversation
                                                    </h3>
                                                    <p style={{color: 'var(--gray-600)', marginBottom: '2rem'}}>
                                                        Be the first to share your ideas and help shape our community's future!
                                                    </p>
                                                    <button className="btn btn-primary" onClick={() => setActiveTab('contribute')}>
                                                        Share Your Ideas
                                                    </button>
                                                </div>
                                            ) : (
                                                <div style={{
                                                    background: 'white',
                                                    borderRadius: '1.5rem',
                                                    padding: '2rem',
                                                    boxShadow: '0 10px 40px rgba(0,0,0,0.05)'
                                                }}>
                                                    <div style={{
                                                        display: 'grid',
                                                        gap: '1.5rem',
                                                        gridTemplateColumns: 'repeat(auto-fit, minmax(300px, 1fr))'
                                                    }}>
                                                        {contributions.map(contribution => (
                                                            <div key={contribution._id} className="contribution">
                                                                <div className="contribution-header">
                                                                    <div className="contribution-title">{contribution.title}</div>
                                                                    <div className="contribution-type">{contribution.type}</div>
                                                                </div>
                                                                <div className="contribution-content">{contribution.content}</div>
                                                                <div style={{
                                                                    fontSize: '0.875rem',
                                                                    color: 'var(--gray-500)',
                                                                    marginTop: '1rem',
                                                                    display: 'flex',
                                                                    justifyContent: 'space-between',
                                                                    alignItems: 'center'
                                                                }}>
                                                                    <span>
                                                                        By {contribution.author} ‚Ä¢ {new Date(contribution.createdAt).toLocaleDateString()}
                                                                    </span>
                                                                    {contribution.status === 'pending' && (
                                                                        <span style={{
                                                                            background: 'var(--warning-color)',
                                                                            color: 'white',
                                                                            padding: '0.25rem 0.5rem',
                                                                            borderRadius: '0.5rem',
                                                                            fontSize: '0.75rem'
                                                                        }}>
                                                                            Under Review
                                                                        </span>
                                                                    )}
                                                                </div>
                                                            </div>
                                                        ))}
                                                    </div>
                                                </div>
                                            )}
                                        </div>
                                    </div>
                                </section>
                            )}
                        </main>

                        {/* Admin Modal */}
                        {showAdmin && (
                            <div className="admin-overlay">
                                <div className="admin-modal">
                                    <div className="admin-header">
                                        <h2 className="admin-title">CivicLabs Administration</h2>
                                        <p className="admin-subtitle">Configure your community engagement platform</p>
                                    </div>

                                    <div className="admin-body">
                                        <form onSubmit={(e) => {
                                            e.preventDefault();
                                            const formData = new FormData(e.target);
                                            handleSaveConfig({
                                                orgName: formData.get('orgName'),
                                                primaryColor: formData.get('primaryColor'),
                                                contactEmail: formData.get('contactEmail'),
                                                logoUrl: formData.get('logoUrl'),
                                                welcomeMessage: formData.get('welcomeMessage'),
                                                tagline: formData.get('tagline'),
                                                organizationType: formData.get('organizationType'),
                                                enableSurveys: formData.get('enableSurveys') === 'on',
                                                enableVolunteering: formData.get('enableVolunteering') === 'on',
                                                enablePublicConsultations: formData.get('enablePublicConsultations') === 'on',
                                                moderationSettings: {
                                                    requireApproval: formData.get('requireApproval') === 'on',
                                                    enableModeration: formData.get('enableModeration') === 'on',
                                                    allowAnonymous: formData.get('allowAnonymous') === 'on'
                                                }
                                            });
                                        }} className="admin-form">
                                            <div className="admin-section">
                                                <h3 className="admin-section-title">üèõÔ∏è Organization Settings</h3>
                                                <div className="form-row">
                                                    <div className="form-group">
                                                        <label htmlFor="orgName">Organization Name</label>
                                                        <input
                                                            type="text"
                                                            id="orgName"
                                                            name="orgName"
                                                            defaultValue={config.orgName}
                                                            placeholder="Your organization name"
                                                        />
                                                    </div>

                                                    <div className="form-group">
                                                        <label htmlFor="organizationType">Organization Type</label>
                                                        <select id="organizationType" name="organizationType" defaultValue={config.organizationType}>
                                                            <option value="Local Government">Local Government</option>
                                                            <option value="Municipal Department">Municipal Department</option>
                                                            <option value="Civic Nonprofit">Civic Nonprofit</option>
                                                            <option value="Regional Agency">Regional Agency</option>
                                                            <option value="Community Group">Community Group</option>
                                                            <option value="Other">Other</option>
                                                        </select>
                                                    </div>
                                                </div>

                                                <div className="form-row">
                                                    <div className="form-group">
                                                        <label htmlFor="primaryColor">Brand Color</label>
                                                        <input
                                                            type="color"
                                                            id="primaryColor"
                                                            name="primaryColor"
                                                            defaultValue={config.primaryColor}
                                                        />
                                                    </div>

                                                    <div className="form-group">
                                                        <label htmlFor="contactEmail">Contact Email</label>
                                                        <input
                                                            type="email"
                                                            id="contactEmail"
                                                            name="contactEmail"
                                                            defaultValue={config.contactEmail}
                                                            placeholder="contact@yourorg.gov"
                                                        />
                                                    </div>
                                                </div>

                                                <div className="form-group">
                                                    <label htmlFor="logoUrl">Logo URL</label>
                                                    <input
                                                        type="url"
                                                        id="logoUrl"
                                                        name="logoUrl"
                                                        defaultValue={config.logoUrl}
                                                        placeholder="https://yourorg.gov/logo.png"
                                                    />
                                                </div>
                                            </div>

                                            <div className="admin-section">
                                                <h3 className="admin-section-title">üìù Platform Content</h3>
                                                <div className="form-group">
                                                    <label htmlFor="welcomeMessage">Welcome Message</label>
                                                    <textarea
                                                        id="welcomeMessage"
                                                        name="welcomeMessage"
                                                        defaultValue={config.welcomeMessage}
                                                        placeholder="Welcome message for visitors"
                                                        rows="3"
                                                    />
                                                </div>

                                                <div className="form-group">
                                                    <label htmlFor="tagline">Platform Tagline</label>
                                                    <input
                                                        type="text"
                                                        id="tagline"
                                                        name="tagline"
                                                        defaultValue={config.tagline}
                                                        placeholder="Brief tagline for your platform"
                                                    />
                                                </div>
                                            </div>

                                            <div className="admin-section">
                                                <h3 className="admin-section-title">‚öôÔ∏è Engagement Features</h3>
                                                <div style={{display: 'grid', gap: '1rem'}}>
                                                    <label style={{display: 'flex', alignItems: 'center', gap: '0.5rem'}}>
                                                        <input type="checkbox" name="enableSurveys" defaultChecked={config.enableSurveys} />
                                                        Enable survey and polling features
                                                    </label>

                                                    <label style={{display: 'flex', alignItems: 'center', gap: '0.5rem'}}>
                                                        <input type="checkbox" name="enableVolunteering" defaultChecked={config.enableVolunteering} />
                                                        Enable volunteer signup and management
                                                    </label>

                                                    <label style={{display: 'flex', alignItems: 'center', gap: '0.5rem'}}>
                                                        <input type="checkbox" name="enablePublicConsultations" defaultChecked={config.enablePublicConsultations} />
                                                        Enable public consultation workflows
                                                    </label>
                                                </div>
                                            </div>

                                            <div className="admin-section">
                                                <h3 className="admin-section-title">üõ°Ô∏è Moderation & Privacy</h3>
                                                <div style={{display: 'grid', gap: '1rem'}}>
                                                    <label style={{display: 'flex', alignItems: 'center', gap: '0.5rem'}}>
                                                        <input type="checkbox" name="requireApproval" defaultChecked={config.moderationSettings.requireApproval} />
                                                        Require admin approval for contributions before publication
                                                    </label>

                                                    <label style={{display: 'flex', alignItems: 'center', gap: '0.5rem'}}>
                                                        <input type="checkbox" name="enableModeration" defaultChecked={config.moderationSettings.enableModeration} />
                                                        Enable content moderation tools
                                                    </label>

                                                    <label style={{display: 'flex', alignItems: 'center', gap: '0.5rem'}}>
                                                        <input type="checkbox" name="allowAnonymous" defaultChecked={config.moderationSettings.allowAnonymous} />
                                                        Allow anonymous contributions
                                                    </label>
                                                </div>
                                            </div>

                                            <div className="form-actions">
                                                <button type="button" className="btn btn-secondary" onClick={() => setShowAdmin(false)}>
                                                    Cancel
                                                </button>
                                                <button type="submit" className="btn btn-primary">
                                                    Save Configuration
                                                </button>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        )}

                        {/* Footer */}
                        <footer className="footer">
                            <div className="container">
                                <div className="footer-content">
                                    <div className="footer-section">
                                        <h3>üèõÔ∏è {config.orgName}</h3>
                                        <p>{config.organizationType} - Building stronger communities through meaningful engagement and collaboration.</p>
                                        <p style={{marginTop: '1rem'}}>
                                            <strong>Contact:</strong> {config.contactEmail}
                                        </p>
                                    </div>

                                    <div className="footer-section">
                                        <h3>üéØ Civic Engagement</h3>
                                        <p>‚Ä¢ Public consultations & surveys</p>
                                        <p>‚Ä¢ Community challenges & initiatives</p>
                                        <p>‚Ä¢ Volunteer opportunities</p>
                                        <p>‚Ä¢ Transparent decision-making</p>
                                    </div>

                                    <div className="footer-section">
                                        <h3>üîó Platform Features</h3>
                                        <p><a href="#" onClick={() => setActiveTab('challenges')}>Active Challenges</a></p>
                                        <p><a href="#" onClick={() => setActiveTab('contribute')}>Share Ideas</a></p>
                                        <p><a href="#" onClick={() => setActiveTab('contributions')}>Community Dialogue</a></p>
                                        <p><a href="#" onClick={() => setShowAdmin(true)}>Admin Settings</a></p>
                                    </div>
                                </div>

                                <div className="footer-bottom">
                                    <p>&copy; 2024 {config.orgName}. Community engagement platform powered by LabsForAmerica and Fireproof Database.</p>
                                </div>
                            </div>
                        </footer>
                    </div>
                );
            }

            // Contribution Form Component
            function ContributionForm({ onSubmit }) {
                const [formData, setFormData] = React.useState({
                    title: '',
                    content: '',
                    type: 'Idea',
                    author: ''
                });

                const handleSubmit = (e) => {
                    e.preventDefault();
                    if (formData.title && formData.content && formData.author) {
                        onSubmit(formData);
                        setFormData({ title: '', content: '', type: 'Idea', author: '' });
                    }
                };

                const handleChange = (field, value) => {
                    setFormData(prev => ({ ...prev, [field]: value }));
                };

                return (
                    <form onSubmit={handleSubmit}>
                        <div className="form-group">
                            <label htmlFor="author">Your Name</label>
                            <input
                                type="text"
                                id="author"
                                value={formData.author}
                                onChange={(e) => handleChange('author', e.target.value)}
                                placeholder="Enter your name"
                                required
                            />
                        </div>

                        <div className="form-group">
                            <label htmlFor="title">Contribution Title</label>
                            <input
                                type="text"
                                id="title"
                                value={formData.title}
                                onChange={(e) => handleChange('title', e.target.value)}
                                placeholder="Brief title for your contribution"
                                required
                            />
                        </div>

                        <div className="form-group">
                            <label htmlFor="type">Type</label>
                            <select
                                id="type"
                                value={formData.type}
                                onChange={(e) => handleChange('type', e.target.value)}
                            >
                                <option value="Idea">üí° Idea</option>
                                <option value="Feedback">üí¨ Feedback</option>
                                <option value="Question">‚ùì Question</option>
                                <option value="Resource">üîó Resource</option>
                                <option value="Other">üìù Other</option>
                            </select>
                        </div>

                        <div className="form-group">
                            <label htmlFor="content">Your Contribution</label>
                            <textarea
                                id="content"
                                value={formData.content}
                                onChange={(e) => handleChange('content', e.target.value)}
                                placeholder="Share your thoughts, ideas, or feedback..."
                                required
                            />
                        </div>

                        <button type="submit" className="btn">
                            Submit Contribution
                        </button>
                    </form>
                );
            }

            // Admin Form Component
            function AdminForm({ config, onSave, onCancel }) {
                const [formData, setFormData] = React.useState(config);

                const handleChange = (field, value) => {
                    setFormData(prev => ({ ...prev, [field]: value }));
                };

                const handleSubmit = (e) => {
                    e.preventDefault();
                    onSave(formData);
                };

                return (
                    <form onSubmit={handleSubmit} className="admin-form">
                        <div className="form-row">
                            <div className="form-group">
                                <label htmlFor="orgName">Organization Name</label>
                                <input
                                    type="text"
                                    id="orgName"
                                    value={formData.orgName}
                                    onChange={(e) => handleChange('orgName', e.target.value)}
                                    placeholder="Your organization name"
                                />
                            </div>

                            <div className="form-group">
                                <label htmlFor="primaryColor">Primary Color</label>
                                <input
                                    type="color"
                                    id="primaryColor"
                                    value={formData.primaryColor}
                                    onChange={(e) => handleChange('primaryColor', e.target.value)}
                                />
                            </div>
                        </div>

                        <div className="form-row">
                            <div className="form-group">
                                <label htmlFor="contactEmail">Contact Email</label>
                                <input
                                    type="email"
                                    id="contactEmail"
                                    value={formData.contactEmail}
                                    onChange={(e) => handleChange('contactEmail', e.target.value)}
                                    placeholder="contact@example.com"
                                />
                            </div>

                            <div className="form-group">
                                <label htmlFor="logoUrl">Logo URL (optional)</label>
                                <input
                                    type="url"
                                    id="logoUrl"
                                    value={formData.logoUrl}
                                    onChange={(e) => handleChange('logoUrl', e.target.value)}
                                    placeholder="https://example.com/logo.png"
                                />
                            </div>
                        </div>

                        <div className="form-actions">
                            <button type="button" className="btn btn-secondary" onClick={onCancel}>
                                Cancel
                            </button>
                            <button type="submit" className="btn">
                                Save Settings
                            </button>
                        </div>
                    </form>
                );
            }

            // Render the app
            const root = ReactDOM.createRoot(document.getElementById('root'));
            root.render(<CivicLabsApp />);
            
            // Add error handling
            setTimeout(() => {
                const rootElement = document.getElementById('root');
                if (rootElement && rootElement.innerHTML.includes('Loading CivicLabs')) {
                    rootElement.innerHTML = `
                        <div style="text-align: center; padding: 50px; font-family: Arial, sans-serif;">
                            <h2 style="color: #dc2626;">Loading Error</h2>
                            <p>The application failed to load. This might be due to:</p>
                            <ul style="text-align: left; max-width: 400px; margin: 20px auto;">
                                <li>Slow internet connection</li>
                                <li>JavaScript disabled</li>
                                <li>Browser compatibility issues</li>
                            </ul>
                            <p><button onclick="location.reload()" style="padding: 10px 20px; background: #2563eb; color: white; border: none; border-radius: 5px; cursor: pointer;">Try Again</button></p>
                        </div>
                    `;
                }
            }, 30000);
        `;
        document.head.appendChild(script);
    </script>
</body>
</html>
